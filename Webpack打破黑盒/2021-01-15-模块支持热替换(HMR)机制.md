- 使用webpack Dev Serve可以让我们在开发过程中专注编码，因为它自动监视我们代码的变化然后进行自动打包，刷新浏览器。

- webpack可以监视到文件的变化，然后刷新浏览器，但是页面一旦刷新，页面中的任何操作状态都将丢失。

- 解决页面刷新，页面中操作丢失的方法就是：模块热替换（HMR）
  - hot module replacement
  - 计算机行业有个名词叫做：热拔插，指的就是我们可以在一个正在运行的机器上随时插拔设备，机器的运行状态不会受插拔的影响，而且插上去的设备可以立即工作。
  
- webpack中的模块热替换，指的是我们可以在应用运行过程中，实时的去替换应用中的某个模块，而应用的运行状态不会因此而改变。
  - 使用HMR之后，浏览器不会刷新页面，而是直接执行了刚刚修改的这个模块；

- HMR可以算是webpack中最强大的特性之一了

### 开启HMR

- HMR已经集成在了webpack模块中，最简单的使用方式：
  - `webpack-dev-server --hot`命令
  - 也可以在配置文件中添加相应的配置来开启这个功能
    - 1.devServer对象的hot属性设置未true
    - 2.然后需要载入一个插件，这个插件是webpack内置的一个插件，所以我们先导入webpack模块，之后使用HotModuleReplacementPlugin的插件

### HMR的疑问

 通过之前的体验我们发现模块热替换确实提供了非常友好的体验，但是当我们自己去尝试开启 HMR 过后，效果却不尽如人意。

很明显：HMR 并不像 Webpack 的其他特性一样可以开箱即用，需要有一些额外的操作。

具体来说，Webpack 中的 HMR 需要我们手动通过代码去处理，当模块更新过后该，如何把更新后的模块替换到页面中。

- 问：开启HMR之后，为什么样式文件的修改就可以直接热更新？
- 答：因为样式文件是经过Loader处理的，在style-loader中就已经自动处理了样式文件的热更新。所以不需要我们额外的手动去处理。

- 问：为什么样式可以自动处理，而我们的脚本就需要自己手动处理？
- 答：so easy，因为样式更新之后，只需要把更新后的CSS及时替换到页面中，它就可以覆盖掉之前的样式，从而实现更新。     
  但是，我们所编写的js模块是没有任何规律的，你可能导出一个对象，也可能导出一个字符串、函数，使用时各不相同。所以webpack面对这些毫无规律的js模块，无从下手，根本不知道该如何处理更新后的模块，也就无法直接实现一个可以通用所有情况的模块替换方案。

- 问：那可能还有一些平时使用vue-cli或者create-react-app这种框架的开发者会说，我的项目就没有手动替换，js代码照样可以热替换！
- 答：这是因为你使用的是框架没使用框架开发时，项目中的文件都是有规律的，例如React中要求每个模块导出一个函数或者类，这样就有通用的替换办法，所有这些工具内部都已经帮你实现了通用的替换操作。

- 综上所述，我们还是需要自己手动通过代码来处理，当 JavaScript 模块更新过后，该如何将更新后的模块替换到页面中。

### HMR APIs

- HotModuleReplacementPlugin为我们的js提供了一套用于处理HMR的API，我们需要在我们自己的代码中使用这套API将更新后的模块替换到正在运行的页面中

- module.hot.accept('', ()=> {
  })

- 代码报错，可以使用hotOnly，来保证浏览器页面不会刷新

- React HMR方案

- Vue.js HMR方案

